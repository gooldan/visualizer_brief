# Техническое задание для системы визуализации и обработки данных коллайдерных экспериментов

Данное техническое задание имеет предварительных характер и может измениться в дальнейшем при наличии замечаний, просьб или предложений.

### Функциональные требования:
#

Для более удобной работы с данными, полученными в ходе коллайдерных экспериментов, нам необходим фреймворк, удовлетворяющий следующим требованиям:
1. Рендер не менее 30 FPS на middle-level ноутбуках(с процессором intel core i5 новее чем 5-ого поколения).
2. Возможность интерактивной работы с визуализацией. Редактирование параметров в уже “загруженных” данных не должно загружать программу более чем на 1 секунду.
3. Необходимо иметь возможность пользоваться данной систем без соединения с интернетом.
4. Система должна стабильно работать на 3-ёх оп. системах — Win10, Linux, OS X.
5. Установка системы со всеми её зависимостями должна выполняться в виде запуска одного скрипта/установочного файла с минимальным участием пользователя.
6. Система должна иметь user-friendly API для её расширения и использования
7. Система должна иметь возможность интеграции с Python >3.6
8. Обработка и подготовка данных должна происходить с “высокой” скоростью (н-р должна присутствовать возможность использования векторизованных операций, т.е. н-р в системе имелась возможность выполнить подобную операцию: сложить две колонки разом и посчитать логарифм для каждого числа. Результат добавить к полученным данным как третью колонку)
9. Для конфигурирования не меняющихся данных, настройки системы должны сохраняться в конфигурационных файлах.
##### Желательные требования:

1. Удобная работа с библиотекой Pandas
2. Возможность встраивания в ноутбуки Jupyter (IPython) (без интерактивности)

### Технические требования:

1. Система должна корректно обрабатывать большие объемы данных (н-р уметь загрузить/считать tab-separated TSV файл объемом 200 MB)
2. Система должна уметь визуализировать данные как минимум в 2-ух режимах: 3D и 2D.
3. Система должна иметь удобный интерфейс для работы с данными и их последующей визуализацией:
    Примерный сценарий использования библиотеки:
    1. Пользователь загружает массив данных в систему один раз.
    2. Пользователь на скриптовом языке описывает модель данных и то, как они должны отображаться. Идеальный пример API для работы с данными — библиотека Pandas.
    3. В дальнейшем пользователь работает только с UI самой системы, настраивает цвет, размер и прочие параметры отображаемых групп данных и примитивов

#### Предлагаемый пример описания модели и отображения (pandas-like API):
#
**BMN_visualize_data_model.py** — скрипт выполняется один раз и данные подготавливаются единовременно и далее запускать этот скрипт необходимо только в случае если меняется код написанный в этом файле, далее имеется возможность на основе полученной модели задавать View в runtime не тратя время на предобработку данных
#
```py
....
def preprocess_data_for_LOOT(data):
    self.set_preprocessing_name(“LOOT_01_05_2019”)
    # метод разбивает данные по уникальным значениям перечисленных колонок (см. groupby Pandas)
    grouped_data = data.setGrouping(columnNames={“D”, “E”})
    
    # метод берет перечисленные колонки и возвращает новую колонку, используя векторизованные операции numpy
    processed_column = grouped_data.transformData(columnDataIn={“A”, “B”},
                  transform_func=lambda col_a, col_b: return np.sqrt(col_a.values**2 + col_b.values**4))
    
    # метод добавляет колонку в каждую группу, при этом в исходные данные колонка тоже попадает (т.к. propagate=True)
    grouped_data.pushColumn(name=“P”, data=processed_column, propagate_to_root=True)
    
    # исключает из данных группы по условию (аналог filter для Pandas)
    grouped_data.dropGroup(lambda columns: return False if columns[“P”].mean() < 10 else True)
....
```

**MPD_visualize_config.yaml** — файл настройки режимов работы, используемой модели данных, используемого алгоритма предобработки:
```yaml
…
preprocessing: “LOOT_01_05_2019”
visualize: 
  mode: “2D”
  render: “openGL” # or render: “inline” or render: “image.png”
…
```

**MPD_visualize_data.py**:
```py
...
# API рисования может быть любым, главное чтобы можно было легко визуализировать точки, линии, и исходя из модели
# данных, легко было задавать их цвет, размер, и прочие вещи.
...
```

Вопросы, замечания, предложения, улучшения можно присылать по почте egor.schavelev@gmail.com, либо в issues/pull-request этого репозитория.
